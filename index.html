<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>AttendBuddy - Attendance Calculator</title>
    
    <!-- Link to your CSS file -->
    <link rel="stylesheet" href="styles.css">

    <!-- This script loads your Firebase keys. Make sure config.js is in your .gitignore! -->
    <script src="config.js"></script>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üìö AttendBuddy</h1>
            <p>Your Personal Attendance Calculator</p>
        </div>
        <div class="content">
            <!-- Login Screen -->
            <div id="loginScreen">
                 <div class="login-form" style="text-align: center;">
                    <h2 style="margin-bottom: 30px; color:#333;">Welcome to AttendBuddy</h2>
                    <p style="color: #666; margin-bottom: 30px;">Sign in to track your attendance.</p>
                    <button id="googleSignInBtn">
                        <svg aria-hidden="true" height="20" viewBox="0 0 20 20" width="20" style="display: inline-block; vertical-align: middle; margin-right: 12px;"><g fill-rule="evenodd" clip-rule="evenodd"><path d="M19.9 10.2c0-.8-.1-1.5-.2-2.2H10.2v4.2h5.4c-.2 1.4-.9 2.5-2.1 3.3v2.7h3.5c2-1.9 3.2-4.7 3.2-8z" fill="#4285F4"></path><path d="M10.2 20c2.8 0 5.1-1 6.8-2.6l-3.5-2.7c-.9.6-2.1 1-3.3 1-2.5 0-4.7-1.7-5.5-4H1.1v2.8C2.8 17.5 6.2 20 10.2 20z" fill="#34A853"></path><path d="M4.7 12a5.9 5.9 0 010-4V5.2H1.1C.4 6.6 0 8.3 0 10s.4 3.4 1.1 4.8l3.6-2.8z" fill="#FBBC05"></path><path d="M10.2 4c1.5 0 2.9.5 3.9 1.5l3.1-3.1C15.3.6 12.9 0 10.2 0 6.2 0 2.8 2.5 1.1 5.9l3.6 2.8c.8-2.3 3-4 5.5-4z" fill="#EA4335"></path></g></svg>
                        Sign in with Google
                    </button>
                </div>
            </div>
            
            <!-- Timetable Setup -->
            <div id="setupScreen" class="hidden">
                <div class="setup-form">
                    <h2 style="text-align:center; margin-bottom: 30px; color:#333;">Setup Your Weekly Timetable</h2>
                    <p style="text-align:center; margin-bottom: 30px; color:#666;">Set up your schedule for each day of the week</p>
                    <div class="day-tabs" id="setupTabs"></div>
                    <div class="timetable-setup">
                        <div class="form-group">
                            <label for="setupNumPeriods">Number of Periods</label>
                            <select id="setupNumPeriods"></select>
                        </div>
                        <div id="setupPeriods" class="periods-grid"></div>
                    </div>
                    <button id="saveTimetableBtn">Save Complete Timetable</button>
                    <button id="logoutBtnSetup" class="btn-secondary">Logout</button>
                </div>
            </div>
            <!-- Main App -->
            <div id="mainApp" class="hidden">
                <div class="navigation" id="mainNav"></div>
                <!-- Attendance -->
                <div id="attendanceSection">
                    <div class="date-selector">
                        <h3>Mark Attendance</h3>
                        <div class="date-controls">
                            <button id="prevDayBtn">‚Üê Previous Day</button>
                            <div class="current-date" id="currentDate"></div>
                            <button id="nextDayBtn">Next Day ‚Üí</button>
                        </div>
                    </div>
                    <div id="dayInfo" class="day-info"></div>
                    <div id="attendanceGrid" class="timetable-grid"></div>
                    <button id="markHolidayBtn">Mark Today as Holiday</button>
                    <div id="attendanceActions"></div>
                </div>
                <!-- Statistics -->
                <div id="statsSection" class="hidden">
                    <h3 style="text-align:center; margin-bottom:30px;">Attendance Statistics</h3>
                    <div id="statsGrid" class="stats-grid"></div>
                    <div id="overallStatus" class="overall-status"></div>
                    <div id="subjectStats"></div>
                </div>
                <!-- Timetable Edit -->
                <div id="timetableEditSection" class="hidden">
                    <h3 style="text-align:center; margin-bottom:30px;">Edit Weekly Timetable</h3>
                    <div class="day-tabs" id="editTabs"></div>
                    <div class="timetable-setup">
                        <div class="form-group">
                            <label for="editNumPeriods">Number of Periods</label>
                            <select id="editNumPeriods"></select>
                        </div>
                        <div id="editPeriods" class="periods-grid"></div>
                    </div>
                     <!-- New Section for Initial Counts -->
                    <div class="timetable-setup" style="margin-top: 20px;">
                        <h4 style="text-align:center; margin-bottom: 20px; color:#333;">Initial Attendance Counts</h4>
                        <p style="text-align:center; margin-bottom: 20px; color:#666;">Enter the totals from the beginning of the semester here.</p>
                        <div id="initialCountsContainer" class="periods-grid">
                            <!-- Fields will be generated by JavaScript -->
                        </div>
                    </div>
                    <button id="updateTimetableBtn">Update Timetable</button>
                </div>
                <!-- Profile Page -->
                <div id="profileSection" class="hidden">
                    <h3 style="text-align:center; margin-bottom:30px;">Your Profile</h3>
                    <div class="profile-card">
                        <img id="profilePicture" src="https://placehold.co/100x100/E0E7FF/4F46E5?text=User" alt="User Profile Picture" class="profile-picture">
                        <div class="profile-info">
                            <h2 id="profileName">User Name</h2>
                            <p id="profileEmail">user@example.com</p>
                        </div>
                        <button id="profileLogoutBtn" class="btn-danger">Logout</button>
                        <button id="resetDataBtn" class="btn-secondary" style="margin-top: 10px;">Reset Semester Data</button>
                    </div>
                </div>
            </div>
            <!-- Subject Change Modal -->
            <div id="subjectModal" class="hidden">
                <div class="modal-overlay"></div>
                <div class="modal-container">
                    <div class="modal-header">
                        <h3 id="modalTitle">Change Subject for Period </h3>
                        <button id="closeModalBtn">&times;</button>
                    </div>
                    <div class="modal-body">
                        <p>Select the substitute subject that was taught in this period.</p>
                        <div class="form-group">
                            <label for="subjectSelect">New Subject</label>
                            <select id="subjectSelect"></select>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button id="cancelSubjectBtn" class="btn-secondary">Cancel</button>
                        <button id="saveSubjectBtn">Save Change</button>
                    </div>
                </div>
            </div>
            <!-- Reset Confirmation Modal -->
            <div id="resetModal" class="hidden">
                <div class="modal-overlay"></div>
                <div class="modal-container">
                    <div class="modal-header">
                        <h3>Confirm Semester Reset</h3>
                        <button id="closeResetModalBtn">&times;</button>
                    </div>
                    <div class="modal-body">
                        <p style="font-weight: 600; color: var(--danger);">
                            Warning: This is a permanent action!
                        </p>
                        <p>
                            This will delete all of your marked attendance, holidays, and initial counts for the semester. Your timetable will be kept. Are you sure you want to proceed?
                        </p>
                    </div>
                    <div class="modal-footer">
                        <button id="cancelResetBtn" class="btn-secondary">Cancel</button>
                        <button id="confirmResetBtn" class="btn-danger">Yes, Reset My Data</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Link to your JavaScript file -->
    <script type="module" src="script.js"></script>
</body>
</html>
